---
layout:     post
title:      Django实践笔记
subtitle:   
date:       2019-05-27 22:19:14 
author:     terese
header-img: img/post-12.jpg
catalog:   true
tags:
    - Django
---

## Django实践项目遇到的问题

1. django.utils.InternalError:(1049,"Unknown database 'community'")
   在使用mysql数据库前得先创建数据库

- $mysql -u root -p 
- \>create database 数据库名字;

2. django.core.exceptions.ImproperlyConfigured: Error loading MySQLdb module.Did you install mysqlclient?

 订：

$pip3 install mysqlclient

如果还是出现这个是因为 Django 在连接 MySQL 数据库时默认使用的是 MySQLdb 驱动，然而我们没有安装该驱动，因为它并不支持 Python3，我们现在安装的是 PyMySQL 驱动:

$pip install pymysql

然后在django项目的__init__下设置：

然后cmd执行

$ Python3  manage.py makemigations

$Python3 manage.py migrate

因为切换了数据库后，之前 Sqlite3 数据库里的数据并不能复制到 MySQL 中，所以需要重新进行数据库同步，使数据模型重新在 MySQL 数据库中生成表。



3. File "/Users/terese/Desktop/Community/home/urls.py", line 8, in <module>

path('', home.home, name='home'),AttributeError: 'function' object has no attribute 'home'



4. NoReverseMatch at /signup/

Reverse for 'home' not found. 'home' is not a valid view function or pattern name.



5. TypeError: index() missing 1 required positional argument: 'request'

原因：

path(**'****’**,views.index（）,name='index'),用了.index()

订正：

改为views.index就好了

6. TemplateDoesNotExist at /

原因：

因为settings 没有被告诉template文件夹的位置

订正：

**加上** **'DIRS'**: [os.path.join(BASE_DIR, **'templates'**)],

```python
TEMPLATES = [

  {

  **'BACKEND'**: **'django.template.backends.django.DjangoTemplates'**,

   **'DIRS'**: [os.path.join(BASE_DIR, **'templates'**)],

   **'APP_DIRS'**: **True**
   }
```

7. ''static'' is not a registered tag library. Must be one of: admin_list admin_modify admin_static admin_urls cache i18n l10n log static staticfiles tz

django.template.exceptions.TemplateSyntaxError: ''static'' is not a registered tag library. Must be one of:  static、staticfiles

原因：没有成功载入static，因为把static写成了’static’，多了引号

订正：{% load static %}



8. django.urls.exceptions.NoReverseMatch: Reverse for 'add_book/' not found. 'add_book/' is not a valid view function or pattern name.

原因：没有add_book/这个url的名字，所以找不到，应该是add_book

path(**'add_book/'**,views.add_book,name=**'add_book****’**)#此处定义为add_book为URL名称

```
<**li**><**a** **href=****"{% url 'add_book/' %}"**>发布图书</**a**></**li**>
```

订正为：

```<**li**><**a** **href=****"{% url 'add_book' %}"**>发布图书</**a**></**li**>	```

9. django.template.exceptions.TemplateSyntaxError: Invalid block tag on line 21: 'endblock'. Did you forget to register or load this tag?

原因：注意到没有，下面第一个{与%间有空格 

{ % block content %}

订正：

{% block content %}



10. "GET /static/home/home.css HTTP/1.1" 404 1663不能载入到网页

原因：检查一下home.css保存的位置是不是在 /static/home/home.css，发现在文件夹home的外面，

订正：

把文件拉到正确的位置



## Django项目迁移前注意步骤

1. sudo pip3 install Django==2.1.0(安装对应版本的Django)
2. 在终端中输入以下命令进入 MySQL 数据库：
       $ sudo service mysql start # 启动 MySQL 服务器
       $ mysql -u root  -p# 进入 MySQL

3. MySQL 交互命令行中继续输入命令，创建数据库：
   \>create database ***;（创建对应的数据库）
4. 配置数据库
   要让 Django 使用 MySQL 数据库，需要下载第三方模块：
   $ sudo pip3 install mysqlclient
5. 配置项目中的settings.py 
   DATABASES = {
     'default': {
       'ENGINE': 'django.db.backends.mysql',
       'NAME': '****',#填入数据库名称
       'USER': 'root',
       'PASSWORD': '  ',#填入数据库密码
       'HOST': '127.0.0.1',
       'PORT': '3306',
     }
   }
   修改时区：TIME_ZONE = 'Asia/Shanghai'
6. 迁移数据库
   在项目根目录里输入命令，迁移数据库：
   $ python3 manage.py makemigrations
   $ python3 manage.py migrate
7. 若要进入管理员后台http://127.0.0.1:8000/admin/，要创建超级管理员
   python3 manage.py createsuperuser
8. 与git版本控制相关

- cd 这个工程路径/
- git init //把这个目录变成Git可以管理的仓库
- git add README.md //文件添加到仓库
- git add . #上传当前目录下所有未追踪的文件全部add了

 或者git add 文件夹名称/ #上传单一文件

- git commit -m "first commit" //把文件提交到仓库
-  git remote add origin git@github.com:[用户名]/[仓库名].git //关联远程仓库

eg：git@github.com:A** /B**.git

-  git push -u origin master //把本地库的所有内容推送到远程库上

 