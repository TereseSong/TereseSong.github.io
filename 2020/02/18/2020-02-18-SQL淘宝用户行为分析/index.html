<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>SQL淘宝用户行为分析 - Terese&#039;s Blog</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="Terese&#039;s Blog"><meta name="msapplication-TileImage" content="/img/avatar.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Terese&#039;s Blog"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="一、定义问题本次分析通过对淘宝用户行为数据进行分析，为以下问题提供解释和改进建议：1.分析用户消费行为，通过分析常见电商分析指标，确定各个环节的流失率，找到需要改进的环节2.研究用户在不同时间尺度下的行为规律，找到用户在不同时间周期下的活跃规律3.对用户群体进行分群，对不同价值对用户给出不同对营销建议"><meta property="og:type" content="blog"><meta property="og:title" content="SQL淘宝用户行为分析"><meta property="og:url" content="https://teresesong.github.io/2020/02/18/2020-02-18-SQL%E6%B7%98%E5%AE%9D%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E5%88%86%E6%9E%90/"><meta property="og:site_name" content="Terese&#039;s Blog"><meta property="og:description" content="一、定义问题本次分析通过对淘宝用户行为数据进行分析，为以下问题提供解释和改进建议：1.分析用户消费行为，通过分析常见电商分析指标，确定各个环节的流失率，找到需要改进的环节2.研究用户在不同时间尺度下的行为规律，找到用户在不同时间周期下的活跃规律3.对用户群体进行分群，对不同价值对用户给出不同对营销建议"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://teresesong.github.io/img/post-14.jpg"><meta property="article:published_time" content="2020-02-17T16:00:00.000Z"><meta property="article:modified_time" content="2022-10-05T10:27:54.504Z"><meta property="article:author" content="terese"><meta property="article:tag" content="实践"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="https://teresesong.github.io/img/post-14.jpg"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://teresesong.github.io/2020/02/18/2020-02-18-SQL%E6%B7%98%E5%AE%9D%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E5%88%86%E6%9E%90/"},"headline":"SQL淘宝用户行为分析","image":["https://teresesong.github.io/img/post-14.jpg"],"datePublished":"2020-02-17T16:00:00.000Z","dateModified":"2022-10-05T10:27:54.504Z","author":{"@type":"Person","name":"terese"},"publisher":{"@type":"Organization","name":"Terese's Blog","logo":{"@type":"ImageObject","url":{"text":"Terese's site"}}},"description":"一、定义问题本次分析通过对淘宝用户行为数据进行分析，为以下问题提供解释和改进建议：1.分析用户消费行为，通过分析常见电商分析指标，确定各个环节的流失率，找到需要改进的环节2.研究用户在不同时间尺度下的行为规律，找到用户在不同时间周期下的活跃规律3.对用户群体进行分群，对不同价值对用户给出不同对营销建议"}</script><link rel="canonical" href="https://teresesong.github.io/2020/02/18/2020-02-18-SQL%E6%B7%98%E5%AE%9D%E7%94%A8%E6%88%B7%E8%A1%8C%E4%B8%BA%E5%88%86%E6%9E%90/"><link rel="icon" href="/img/avatar.png"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!--!--><!--!--><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const $tabMenu = document.querySelector(`a[href="${location.hash}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(location.hash);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/">Terese&#039;s site</a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="目录" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><div class="card-image"><span class="image is-7by3"><img class="fill" src="/img/post-14.jpg" alt="SQL淘宝用户行为分析"></span></div><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2020-02-17T16:00:00.000Z" title="2020/2/18 00:00:00">2020-02-18</time>发表</span><span class="level-item"> terese </span><span class="level-item"><a class="link-muted" href="/categories/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/">数据分析</a></span><span class="level-item">14 分钟读完 (大约2143个字)</span></div></div><h1 class="title is-3 is-size-4-mobile">SQL淘宝用户行为分析</h1><div class="content"><h3 id="一、定义问题"><a href="#一、定义问题" class="headerlink" title="一、定义问题"></a>一、定义问题</h3><p>本次分析通过对淘宝用户行为数据进行分析，为以下问题提供解释和改进建议：<br>1.分析用户消费行为，通过分析常见电商分析指标，确定各个环节的流失率，找到需要改进的环节<br>2.研究用户在不同时间尺度下的行为规律，找到用户在不同时间周期下的活跃规律<br>3.对用户群体进行分群，对不同价值对用户给出不同对营销建议</p>
<span id="more"></span>
<h3 id="二、数据理解"><a href="#二、数据理解" class="headerlink" title="二、数据理解"></a>二、数据理解</h3><h4 id="建表"><a href="#建表" class="headerlink" title="建表"></a>建表</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `tb` (</span><br><span class="line">  `user_id` <span class="type">varchar</span>(<span class="number">7</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `item_id` <span class="type">varchar</span>(<span class="number">7</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `category_id` <span class="type">varchar</span>(<span class="number">7</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `behavior_type` <span class="type">varchar</span>(<span class="number">4</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `timestamps` datetime <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `dates` <span class="type">date</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `time_hour` <span class="type">varchar</span>(<span class="number">2</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span></span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8;</span><br></pre></td></tr></table></figure>

<h4 id="导入数据"><a href="#导入数据" class="headerlink" title="导入数据"></a>导入数据</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">LOAD DATA <span class="keyword">LOCAL</span> INFILE <span class="string">&#x27;/Users/terese/Downloads/UserBehavior_million.csv&#x27;</span></span><br><span class="line"><span class="keyword">INTO</span> <span class="keyword">TABLE</span> tb</span><br><span class="line">FIELDS TERMINATED <span class="keyword">BY</span> <span class="string">&#x27;,&#x27;</span>;</span><br><span class="line"><span class="comment">--IGNORE 1 LINES;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/00831rSTgy1gdl5zvnrnnj30fi02qjrk.jpg" alt="image-20200407140113754"></p>
<p>删除index、修改tmiestamp，index、timestamp是MySQL保留字，为了保证后续操作不报错，删除index列、改tmiestamp为timestamps。</p>
<p><img src="https://tva1.sinaimg.cn/large/00831rSTgy1gdl9ufha6bj30ec01a748.jpg" alt="image-20200407161443383"></p>
<p>SQL中查询前几条</p>
<p><code>SELECT * FROM tb LIMIT 5; </code></p>
<p><img src="https://tva1.sinaimg.cn/large/00831rSTgy1gdl9vx6vegj30ig04g3yx.jpg" alt="image-20200407161604579"></p>
<h3 id="三、数据清洗"><a href="#三、数据清洗" class="headerlink" title="三、数据清洗"></a>三、数据清洗</h3><p><strong>查看各字段的数据</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">	COUNT( DISTINCT tb.user_id ) 用户数,</span><br><span class="line">	COUNT( DISTINCT tb.item_id ) 商品数,</span><br><span class="line">	COUNT( DISTINCT tb.category_id ) 商品类目数,</span><br><span class="line">	count( tb.behavior_type ) AS 所有行为数 </span><br><span class="line">FROM tb;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/00831rSTgy1gdl79qqebvj30fv04zmxk.jpg" alt="image-20200407144521068"></p>
<p>本次分析9739名用户共计100万条行为数据，商品数399115，商品类目数5796。</p>
<h4 id="删除重复值"><a href="#删除重复值" class="headerlink" title="删除重复值"></a>删除重复值</h4><p>查询重复</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SELECT user_id,item_id,category_id,behavior_type,timestamps FROM tb</span><br><span class="line">GROUP BY</span><br><span class="line">	user_id,item_id,category_id,behavior_type,timestamps</span><br><span class="line">HAVING</span><br><span class="line">	COUNT(*)&gt;1;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/00831rSTgy1gdl9xibtw2j30ln045jro.jpg" alt="image-20200407161741147"></p>
<p>可以看到无重复值</p>
<h4 id="查询缺失值"><a href="#查询缺失值" class="headerlink" title="查询缺失值"></a>查询缺失值</h4><p>（对比共计100万条行为数据）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">SELECT </span><br><span class="line">	COUNT(user_id), COUNT(item_id), COUNT(category_id),</span><br><span class="line">	COUNT(behavior_type), COUNT(timestamps)</span><br><span class="line">FROM tb;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/00831rSTgy1gdl7q32eigj30lm04eaaa.jpg" alt="image-20200407150103249"></p>
<p>数据全部为100万，所以没有缺失值。</p>
<h4 id="一致化处理"><a href="#一致化处理" class="headerlink" title="一致化处理"></a>一致化处理</h4><p>一致化处理就是对数据进行数据抽取，使得数据字段满足基本的数据分析需求。</p>
<p>将时间戳转化为日期并提取年月日和小时</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">update tb</span><br><span class="line">set timestamps=FROM_UNIXTIME(timestamps);</span><br><span class="line"></span><br><span class="line">update tb</span><br><span class="line">set dates=date_format(timestamps,&#x27;%Y-%m-%d&#x27;);</span><br><span class="line"></span><br><span class="line">update tb</span><br><span class="line">set time_hour=time_format(timestamps,&#x27;%H&#x27;);</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/00831rSTgy1gdlb0fc8xij30ii01eaa3.jpg" alt="image-20200407165447814"></p>
<p><img src="https://tva1.sinaimg.cn/large/00831rSTgy1gdlbxhlej1j30gk040aah.jpg" alt="image-20200407172630999"></p>
<p><img src="https://tva1.sinaimg.cn/large/00831rSTgy1gdlby6h7xpj30lj04ct95.jpg" alt="image-20200407172713938"></p>
<h4 id="异常值处理"><a href="#异常值处理" class="headerlink" title="异常值处理"></a>异常值处理</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">select </span><br><span class="line">	count(timestamps),</span><br><span class="line">	count(dates),count(dates),count(time_hour) </span><br><span class="line">from tb;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/00831rSTgy1gdlc6oz4bvj30i20483yn.jpg" alt="image-20200407173524632"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select dates,count(behavior_type) from tb group by dates;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/00831rSTgy1gdllxr8nswj30j80gz75y.jpg" alt="image-20200407231248870"></p>
<p>由于分析的日期在2017-11-25到2017-12-03日的行为数据，其他日期数据不全，应该删除。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">delete from tb where dates between &#x27;2017-09-11&#x27; and &#x27;2017-11-24&#x27;;</span><br><span class="line">delete from tb where dates=&#x27;2017-12-04&#x27;;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/00831rSTgy1gdlm5ackazj30l301k0ss.jpg" alt="image-20200407232002926"><img src="https://tva1.sinaimg.cn/large/00831rSTgy1gdlm5mfywcj30jh01xgln.jpg" alt="image-20200407232022949"></p>
<h4 id="查看空值"><a href="#查看空值" class="headerlink" title="查看空值"></a>查看空值</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM tb WHERE user_id IS NULL OR item_id IS NULL OR category_id IS NULL OR behavior_type IS NULL OR timestamps IS NULL OR dates IS NULL OR time_hour IS NULL;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/00831rSTgy1gdldq4dludj30hy01igln.jpg" alt="image-20200407182841504"></p>
<p>可以看到没有空值</p>
<h3 id="四、构建模型（描述分析）"><a href="#四、构建模型（描述分析）" class="headerlink" title="四、构建模型（描述分析）"></a>四、构建模型（描述分析）</h3><h4 id="基于AARRR行为漏斗模型分析用户行为"><a href="#基于AARRR行为漏斗模型分析用户行为" class="headerlink" title="基于AARRR行为漏斗模型分析用户行为"></a>基于AARRR行为漏斗模型分析用户行为</h4><p>用户角度  </p>
<h5 id="（1）用户总行为漏斗分析"><a href="#（1）用户总行为漏斗分析" class="headerlink" title="（1）用户总行为漏斗分析"></a>（1）用户总行为漏斗分析</h5><p><strong>UV、PV、PV&#x2F;UV</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">SELECT  COUNT(DISTINCT user_id) uv,</span><br><span class="line">	(SELECT COUNT(*) FROM tb WHERE behavior_type = &#x27;pv&#x27;) pv,</span><br><span class="line">	(SELECT COUNT(*) FROM tb WHERE behavior_type = &#x27;pv&#x27;) / COUNT(DISTINCT user_id) as &#x27;pv/uv&#x27;</span><br><span class="line">FROM tb;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/00831rSTgy1gdlm6jbwycj30l606m0tf.jpg" alt="image-20200407232115623"> !</p>
<p> 独立访客数（UV）：9739<br> 页面访客数（PV）：895637<br> 人均页面访问数（PV&#x2F;UV） ：92</p>
<p><strong>跳出率</strong> </p>
<p>跳出率&#x3D;只点击一次浏览的用户数量&#x2F;总用户访问量</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">SELECT </span><br><span class="line">	count(*) as 跳出用户, COUNT(*)/895637 as 跳出率</span><br><span class="line">	FROM</span><br><span class="line">(SELECT </span><br><span class="line"> 	user_id FROM tb</span><br><span class="line"> 	GROUP BY user_id</span><br><span class="line"> 	HAVING COUNT(behavior_type)=1) as look_once;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/00831rSTgy1gdlm81ji7kj30k7073aas.jpg" alt="image-20200407232241233"></p>
<p>跳出率为0%</p>
<p> 用户激活转化率 </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">	behavior_type, count(*)</span><br><span class="line">FROM</span><br><span class="line">	tb</span><br><span class="line">GROUP BY behavior_type;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/00831rSTgy1gdlm8e8wejj30ju07pq3k.jpg" alt="image-20200407232302768"></p>
<p>用户行为流失率 </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select 1-((55447+20359)/895637)  流失率1;select 1-(20359/(55447+28088)) 流失率2;select 1-(20359/895637) 流失率3;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/00831rSTgy1gdlma49uklj30l70c4aay.jpg" alt="image-20200407232440294"></p>
<p>浏览详情页——加入购物车+收藏流失率： 91.54%<br>加入购物车+收藏——购买流失率： 75.63%<br>浏览详情页——购买流失率：97.73%</p>
<p> 用户浏览-购买转化率 </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select (20359/895637) 用户浏览到购买转化率;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/00831rSTgy1gdlmb0f2zwj30l304eweu.jpg" alt="image-20200407232533132"></p>
<p>用户浏览-购买转化率为2.27%</p>
<h5 id="（2）独立访客漏斗模型计算"><a href="#（2）独立访客漏斗模型计算" class="headerlink" title="（2）独立访客漏斗模型计算"></a>（2）独立访客漏斗模型计算</h5><p>  **用户付费转化率 **</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="keyword">DISTINCT</span> user_id) 独立访客数</span><br><span class="line"><span class="keyword">FROM</span> tb</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> behavior_type</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="built_in">COUNT</span>(<span class="keyword">DISTINCT</span> user_id) <span class="keyword">DESC</span>;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/00831rSTgy1gdlkmeu24yj30mk07njs3.jpg" alt="image-20200407222718666"></p>
<p>计算得到付费转化率为：</p>
<p>上面是每一步用户行为的独立用户数，可以看到使用淘宝的用户中有68%的付费用户，用户付费转化率相当高。</p>
<h5 id="（3）用户复购率"><a href="#（3）用户复购率" class="headerlink" title="（3）用户复购率"></a>（3）用户复购率</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">-- 计算复购人数</span><br><span class="line">select count(*) 复购人数</span><br><span class="line">from </span><br><span class="line">(select distinct user_id</span><br><span class="line"> from tb</span><br><span class="line">where behavior_type=&#x27;buy&#x27;</span><br><span class="line">group by user_id</span><br><span class="line">having count(behavior_type)&gt;1) as buy2;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/00831rSTgy1gdlkywf8qtj30lw07h3z5.jpg" alt="image-20200407223918516"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT COUNT(DISTINCT user_id) 购买总人数</span><br><span class="line">FROM tb</span><br><span class="line">WHERE behavior_type = &#x27;buy&#x27;;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/00831rSTgy1gdll16ppn2j30ly05mdg9.jpg" alt="image-20200407224130894"></p>
<p><img src="https://tva1.sinaimg.cn/large/00831rSTgy1gdll1lpd80j30d2042glp.jpg" alt="image-20200407224154485"></p>
<p>复购率达到66.16%，这个比率如果长期达到60%以上，则说明公司进入忠诚度模式，应将经营中心放在客户忠诚度上，即鼓励忠诚客户更加频繁地消费</p>
<h4 id="不同时间尺度下用户行为模式分析"><a href="#不同时间尺度下用户行为模式分析" class="headerlink" title="不同时间尺度下用户行为模式分析"></a>不同时间尺度下用户行为模式分析</h4><h5 id="（1）分析九天中每天的用户行为"><a href="#（1）分析九天中每天的用户行为" class="headerlink" title="（1）分析九天中每天的用户行为"></a>（1）分析九天中每天的用户行为</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">select dates,</span><br><span class="line">	sum(case when behavior_type = &#x27;pv&#x27; THEN 1 ELSE 0 END) pv_count,</span><br><span class="line">	sum(case when behavior_type = &#x27;buy&#x27; THEN 1 ELSE 0 END) buy_count,</span><br><span class="line">	sum(case when behavior_type = &#x27;cart&#x27; THEN 1 ELSE 0 END) cart_count,</span><br><span class="line">	sum(case when behavior_type = &#x27;fav&#x27; THEN 1 ELSE 0 END) fav_count</span><br><span class="line">from tb</span><br><span class="line">group by dates</span><br><span class="line">order by dates;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/00831rSTgy1gdlmby0pjrj30kr0cfq4w.jpg" alt="image-20200407232625765"></p>
<h5 id="（2）分析一天内用户每小时的行为"><a href="#（2）分析一天内用户每小时的行为" class="headerlink" title="（2）分析一天内用户每小时的行为"></a>（2）分析一天内用户每小时的行为</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">SELECT time_hour as hours,</span><br><span class="line">SUM(case WHEN behavior_type = &#x27;pv&#x27; THEN 1 ELSE 0 END) pv_count,</span><br><span class="line">SUM(case WHEN behavior_type = &#x27;buy&#x27; THEN 1 ELSE 0 END) buy_count,</span><br><span class="line">sum(case WHEN behavior_type = &#x27;cart&#x27; THEN 1 ELSE 0 END) cart_count,</span><br><span class="line">sum(case WHEN behavior_type = &#x27;fav&#x27; THEN 1 ELSE 0 END) fav_count</span><br><span class="line">FROM tb</span><br><span class="line">GROUP BY time_hour</span><br><span class="line">ORDER BY time_hour;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/00831rSTgy1gdlmi8tilij30l90jzwhq.jpg" alt="image-20200407233230261"></p>
<h4 id="不同商品种类的用户行为"><a href="#不同商品种类的用户行为" class="headerlink" title="不同商品种类的用户行为"></a>不同商品种类的用户行为</h4><h5 id="（1）热度最高的前20个商品"><a href="#（1）热度最高的前20个商品" class="headerlink" title="（1）热度最高的前20个商品"></a>（1）热度最高的前20个商品</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-- 求商品总数</span><br><span class="line">SELECT COUNT(DISTINCT item_id) </span><br><span class="line">FROM tb;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/00831rSTgy1gdln1hdgawj30jq04d3yq.jpg" alt="image-20200407235059142"></p>
<p>商品共计398972种。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">-- 求热度最高的前20个商品</span><br><span class="line">SELECT item_id, COUNT(behavior_type)</span><br><span class="line">FROM tb</span><br><span class="line">GROUP BY item_id</span><br><span class="line">ORDER BY COUNT(behavior_type) DESC</span><br><span class="line">limit 20;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/00831rSTgy1gdlmrl9nk9j30k70g1dhp.jpg" alt="image-20200407234127184"></p>
<h5 id="（2）商品被浏览、收藏、购买、加入购物车排行榜"><a href="#（2）商品被浏览、收藏、购买、加入购物车排行榜" class="headerlink" title="（2）商品被浏览、收藏、购买、加入购物车排行榜"></a>（2）商品被浏览、收藏、购买、加入购物车排行榜</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># 销量前20位的商品</span><br><span class="line">SELECT item_id,COUNT(*)</span><br><span class="line">FROM tb</span><br><span class="line">WHERE behavior_type = &#x27;buy&#x27;</span><br><span class="line">GROUP BY item_id</span><br><span class="line">ORDER BY COUNT(*) desc</span><br><span class="line">LIMIT 20;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/00831rSTgy1gdlnc1hjzjj30ku0gt0ug.jpg" alt="image-20200408000108381"></p>
<p>可以看到销量前20位的商品</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># 浏览前20的商品</span><br><span class="line">SELECT item_id,COUNT(*) </span><br><span class="line">FROM tb</span><br><span class="line">WHERE behavior_type = &#x27;fav&#x27; GROUP BY item_id</span><br><span class="line">ORDER BY COUNT(*) desc </span><br><span class="line">LIMIT 20;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/00831rSTgy1gdlnfw34tej30ku0gddho.jpg" alt="image-20200408000450743"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">-- 收藏前20的商品</span><br><span class="line">SELECT item_id,COUNT(*) </span><br><span class="line">FROM tb</span><br><span class="line">WHERE behavior_type = &#x27;fav&#x27; GROUP BY item_id</span><br><span class="line">ORDER BY COUNT(*) desc </span><br><span class="line">LIMIT 20;</span><br></pre></td></tr></table></figure>

<img src="https://tva1.sinaimg.cn/large/00831rSTgy1gdlnhcws74j30kk0gcabr.jpg" alt="image-20200408000612194" style="zoom:80%;" />

<h5 id="（3）商品复购分析"><a href="#（3）商品复购分析" class="headerlink" title="（3）商品复购分析"></a>（3）商品复购分析</h5><p>​        a. 商品复购排行榜</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">SELECT item_id, COUNT(distinct user_id) buy_times</span><br><span class="line">	FROM tb</span><br><span class="line">	WHERE behavior_type = &#x27;buy&#x27;</span><br><span class="line">	GROUP BY item_id </span><br><span class="line">	order by COUNT(user_id) desc</span><br><span class="line">	limit 20;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/00831rSTgy1gdlo5zypnkj30nm0gvmyx.jpg" alt="image-20200408002955100"></p>
<p>可以看到被复购次数最多的商品id是3122135，被一个用户复购了17次。以上是商品复购top20排行榜</p>
<p>b. 商品复购率</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">-- 统计商品被用户的购买次数</span><br><span class="line">SELECT buy_times,count(item_id)</span><br><span class="line">FROM </span><br><span class="line">	(SELECT item_id, COUNT(user_id) buy_times</span><br><span class="line">	FROM tb</span><br><span class="line">	WHERE behavior_type = &#x27;buy&#x27;</span><br><span class="line">	GROUP BY item_id) as t </span><br><span class="line">GROUP BY buy_times</span><br><span class="line">ORDER BY COUNT(*) DESC;</span><br><span class="line"></span><br><span class="line"># 被购买商品总种数</span><br><span class="line">SELECT COUNT(DISTINCT item_id) </span><br><span class="line">FROM tb</span><br><span class="line">WHERE behavior_type = &#x27;buy&#x27;;</span><br><span class="line"></span><br><span class="line">select 1-(15536/17565) as 商品复购率;</span><br></pre></td></tr></table></figure>

<p><img src="https://tva1.sinaimg.cn/large/00831rSTgy1gdln7gdmk7j30l30dfdh2.jpg" alt="image-20200407235643502"></p>
<p><img src="https://tva1.sinaimg.cn/large/00831rSTgy1gdlna1hj2oj30ku05bdg6.jpg" alt="image-20200407235910532"></p>
<p><img src="https://tva1.sinaimg.cn/large/00831rSTgy1gdlnlenh01j30g603z0sx.jpg" alt="image-20200408001004312"></p>
<p>被用户购买1次的商品有 15536种，被购买商品总种数为17565种，商品复购率为11.55%</p>
<h3 id="五、数据可视化及分析"><a href="#五、数据可视化及分析" class="headerlink" title="五、数据可视化及分析"></a>五、数据可视化及分析</h3><p>数据分析报告见：淘宝用户行为分析及用户价值分析报告</p>
</div><div class="article-licensing box"><div class="licensing-title"><p>SQL淘宝用户行为分析</p><p><a href="https://teresesong.github.io/2020/02/18/2020-02-18-SQL淘宝用户行为分析/">https://teresesong.github.io/2020/02/18/2020-02-18-SQL淘宝用户行为分析/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>作者</h6><p>terese</p></div></div><div class="level-item is-narrow"><div><h6>发布于</h6><p>2020-02-18</p></div></div><div class="level-item is-narrow"><div><h6>更新于</h6><p>2022-10-05</p></div></div><div class="level-item is-narrow"><div><h6>许可协议</h6><p><a class="icons" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="icon fab fa-creative-commons"></i></a><a class="icons" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="icon fab fa-creative-commons-by"></i></a><a class="icons" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="icon fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/%E5%AE%9E%E8%B7%B5/">实践</a></div><!--!--></article></div><!--!--><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2020/03/08/2020-03-08-MySQL%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E7%82%B9/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">MySQL数据库基础知识点</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2020/02/17/2020-02-17-%E3%80%90%E7%BB%9F%E8%AE%A1%E5%AD%A6%E7%AC%94%E8%AE%B0%E3%80%91%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%BF%85%E5%A4%87%E6%8A%80%E8%83%BD3/"><span class="level-item">【统计学笔记】数据分析必备技能3</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><!--!--></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1"><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">目录</h3><ul class="menu-list"><li><a class="level is-mobile" href="#一、定义问题"><span class="level-left"><span class="level-item">1</span><span class="level-item">一、定义问题</span></span></a></li><li><a class="level is-mobile" href="#二、数据理解"><span class="level-left"><span class="level-item">2</span><span class="level-item">二、数据理解</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#建表"><span class="level-left"><span class="level-item">2.1</span><span class="level-item">建表</span></span></a></li><li><a class="level is-mobile" href="#导入数据"><span class="level-left"><span class="level-item">2.2</span><span class="level-item">导入数据</span></span></a></li></ul></li><li><a class="level is-mobile" href="#三、数据清洗"><span class="level-left"><span class="level-item">3</span><span class="level-item">三、数据清洗</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#删除重复值"><span class="level-left"><span class="level-item">3.1</span><span class="level-item">删除重复值</span></span></a></li><li><a class="level is-mobile" href="#查询缺失值"><span class="level-left"><span class="level-item">3.2</span><span class="level-item">查询缺失值</span></span></a></li><li><a class="level is-mobile" href="#一致化处理"><span class="level-left"><span class="level-item">3.3</span><span class="level-item">一致化处理</span></span></a></li><li><a class="level is-mobile" href="#异常值处理"><span class="level-left"><span class="level-item">3.4</span><span class="level-item">异常值处理</span></span></a></li><li><a class="level is-mobile" href="#查看空值"><span class="level-left"><span class="level-item">3.5</span><span class="level-item">查看空值</span></span></a></li></ul></li><li><a class="level is-mobile" href="#四、构建模型（描述分析）"><span class="level-left"><span class="level-item">4</span><span class="level-item">四、构建模型（描述分析）</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#基于AARRR行为漏斗模型分析用户行为"><span class="level-left"><span class="level-item">4.1</span><span class="level-item">基于AARRR行为漏斗模型分析用户行为</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#（1）用户总行为漏斗分析"><span class="level-left"><span class="level-item">4.1.1</span><span class="level-item">（1）用户总行为漏斗分析</span></span></a></li><li><a class="level is-mobile" href="#（2）独立访客漏斗模型计算"><span class="level-left"><span class="level-item">4.1.2</span><span class="level-item">（2）独立访客漏斗模型计算</span></span></a></li><li><a class="level is-mobile" href="#（3）用户复购率"><span class="level-left"><span class="level-item">4.1.3</span><span class="level-item">（3）用户复购率</span></span></a></li></ul></li><li><a class="level is-mobile" href="#不同时间尺度下用户行为模式分析"><span class="level-left"><span class="level-item">4.2</span><span class="level-item">不同时间尺度下用户行为模式分析</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#（1）分析九天中每天的用户行为"><span class="level-left"><span class="level-item">4.2.1</span><span class="level-item">（1）分析九天中每天的用户行为</span></span></a></li><li><a class="level is-mobile" href="#（2）分析一天内用户每小时的行为"><span class="level-left"><span class="level-item">4.2.2</span><span class="level-item">（2）分析一天内用户每小时的行为</span></span></a></li></ul></li><li><a class="level is-mobile" href="#不同商品种类的用户行为"><span class="level-left"><span class="level-item">4.3</span><span class="level-item">不同商品种类的用户行为</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#（1）热度最高的前20个商品"><span class="level-left"><span class="level-item">4.3.1</span><span class="level-item">（1）热度最高的前20个商品</span></span></a></li><li><a class="level is-mobile" href="#（2）商品被浏览、收藏、购买、加入购物车排行榜"><span class="level-left"><span class="level-item">4.3.2</span><span class="level-item">（2）商品被浏览、收藏、购买、加入购物车排行榜</span></span></a></li><li><a class="level is-mobile" href="#（3）商品复购分析"><span class="level-left"><span class="level-item">4.3.3</span><span class="level-item">（3）商品复购分析</span></span></a></li></ul></li></ul></li><li><a class="level is-mobile" href="#五、数据可视化及分析"><span class="level-left"><span class="level-item">5</span><span class="level-item">五、数据可视化及分析</span></span></a></li></ul></div></div><style>#toc .menu-list > li > a.is-active + .menu-list { display: block; }#toc .menu-list > li > a + .menu-list { display: none; }</style><script src="/js/toc.js" defer></script></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">标签</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/%E5%AE%9E%E8%B7%B5/"><span class="tag">实践</span><span class="tag">7</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%AE%9E%E8%B7%B5%E6%80%BB%E7%BB%93/"><span class="tag">实践总结</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%AC%94%E8%AE%B0/"><span class="tag">笔记</span><span class="tag">10</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3/"><span class="tag">问题解决</span><span class="tag">1</span></a></div></div></div></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/">Terese&#039;s site</a><p class="is-size-7"><span>&copy; 2022 terese</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("zh-CN");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "此网站使用Cookie来改善您的体验。",
          dismiss: "知道了！",
          allow: "允许使用Cookie",
          deny: "拒绝",
          link: "了解更多",
          policy: "Cookie政策",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"想要查找什么...","untitled":"(无标题)","posts":"文章","pages":"页面","categories":"分类","tags":"标签"});
        });</script></body></html>